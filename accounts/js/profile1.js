function show() { document.getElementById("login_bar").style.display = "block" } function hide() { document.getElementById("login_bar").style.display = "none" } function submit() { var n = document.getElementById("bio"), a = document.getElementById("fname"), t = document.getElementById("lname"); $.post("userupdatedata", { bio: n.value, fname: a.value, lname: t.value }, function (e, n) { document.getElementById("login_bar").style.display = "none", "" != e && alert(e), location.reload() }) } document.getElementById("usernav").addEventListener("mouseenter", e => { document.getElementById("usernavli").style.display = "block" }), document.getElementById("ulogo").addEventListener("mouseleave", e => { document.getElementById("usernavli").style.display = "none" }), document.getElementById("login_bar").style.display = "none"; var cropper, reader, file, bs_modal = $("#modal"), image = document.getElementById("image"); $("body").on("change", ".image", function (e) { var n = e.target.files, a = function (e) { image.src = e, bs_modal.modal("show") }; n && n.length > 0 && (file = n[0], URL ? a(URL.createObjectURL(file)) : FileReader && ((reader = new FileReader).onload = function (e) { a(reader.result) }, reader.readAsDataURL(file))) }), bs_modal.on("shown.bs.modal", function () { cropper = new Cropper(image, { aspectRatio: 1, viewMode: 3, preview: ".preview" }) }).on("hidden.bs.modal", function () { cropper.destroy(), cropper = null }), $("#crop").click(function () { (canvas = cropper.getCroppedCanvas({ width: 160, height: 160 })).toBlob(function (e) { url = URL.createObjectURL(e); var n = new FileReader; n.readAsDataURL(e), n.onloadend = function () { var e = n.result; $.ajax({ type: "POST", dataType: "json", url: "uploadprofile.php", data: { image: e }, success: function (e) { bs_modal.modal("hide"), location.reload() } }) } }) });